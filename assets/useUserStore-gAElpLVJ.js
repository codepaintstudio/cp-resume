import{G as i,r as a,k as p,y as I}from"./index-CMwTFN8X.js";import{s as n}from"./request-BEeji1y4.js";const f=(e,o)=>n.post("/api/auth/login",{userName:e,userPassword:o}),m=e=>n.get(`/api/usercenter/${e}`),T=()=>n.get("/api/auth/profile"),y=i("user",()=>{const e=a(localStorage.getItem("userId")||"0"),o=a(localStorage.getItem("cp-accessToken")||""),s=a(localStorage.getItem("cp-refreshToken")||"");let l=a({});const u=p(),g=I(()=>!!o.value);return{accessToken:o,refreshToken:s,isLoggedIn:g,userId:e,userInfo:l,getUserInfo:async c=>{try{const r=await m(c);l.value=r.data}catch(r){console.error("获取用户信息失败:",r)}},login:async(c,r)=>{try{const{data:t}=await f(c,r);o.value=t.access_token,s.value=t.refresh_token,e.value=String(t.userId),localStorage.setItem("userId",e.value),localStorage.setItem("cp-accessToken",o.value),localStorage.setItem("cp-refreshToken",s.value),u.push("/")}catch(t){console.error("Login failed:",t)}},logout:()=>{o.value="",s.value="",localStorage.removeItem("cp-accessToken"),localStorage.removeItem("cp-refreshToken"),u.push("/login")}}});export{y as u,T as v};
