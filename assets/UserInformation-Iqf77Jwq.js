import{j as h,r as u,u as k,k as c,l as f,p as s,V as I,x as b,P as m,S as p}from"./vendor-BQcZEzZR.js";import{u as N,s as i}from"./index-D-9_l-Mc.js";const U={class:"flex justify-between items-center w-[100%] h-1/8 px-6 border-b-2 border-[#D9D9D9]"},E={class:"w-[100%] h-7/8 flex flex-col items-center space-y-10 mt-12"},V={class:"flex h-[12vh] items-center"},$={key:0,class:"cursor-default text-black bg-gray-300 opacity-60 w-full h-full text-sm inset-0 absolute flex items-center justify-center"},j={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white"},C={class:"h-[5vh] flex items-center"},F={class:"h-[5vh] flex items-center"},M={class:"h-[5vh] flex items-center"},B=h({__name:"UserInformation",setup(S){const o=N(),n=u(null),t=u({userName:"",userPhoneNumber:"",userEmail:"",avatar:""}),a=u(!1);k(async()=>{await o.getUserInfo(o.userId),t.value={...o.userInfo,avatar:y(o.userInfo.avatar)}});const x=async()=>{try{a.value=!0,await o.updateUserInfo(o.userId,{userName:t.value.userName,userPhoneNumber:t.value.userPhoneNumber,userEmail:t.value.userEmail}),i({type:"success",message:"信息更新成功"})}catch(r){console.error("更新失败:",r),i({type:"error",message:"信息更新失败"})}finally{a.value=!1}},g=()=>{var r;(r=n.value)==null||r.click()},w=async r=>{var l;const e=(l=r.target.files)==null?void 0:l[0];if(e)try{a.value=!0;const v=await o.updateUserInfoWithAvatar(e);t.value.avatar=y(v),i({type:"success",message:"头像更新成功"})}catch(v){console.error("上传失败:",v),i({type:"error",message:"头像上传失败"})}finally{a.value=!1,n.value&&(n.value.value="")}},y=r=>r?r.startsWith("http")?r:`https://cp-center-server.hub.feashow.cn${r.startsWith("/")?r:`/${r}`}`:"",d=u(!1);return(r,e)=>(f(),c("div",null,[s("div",U,[e[6]||(e[6]=s("h2",{class:"text-lg font-semibold"},"基本信息",-1)),s("a",{class:"text-[#3370FF] mr-[2vw] cursor-default hover:text-emerald-500",onClick:e[0]||(e[0]=l=>x())},"确定上传信息")]),s("div",E,[s("div",V,[s("div",{class:"w-[120px] h-[120px] rounded-full flex justify-center items-center relative overflow-hidden bg-gray-300",style:I({backgroundImage:t.value.avatar?`url('${t.value.avatar}')`:"none",backgroundSize:"cover",backgroundPosition:"center"}),onClick:g,onMouseenter:e[1]||(e[1]=l=>d.value=!0),onMouseleave:e[2]||(e[2]=l=>d.value=!1)},[!t.value.avatar||d.value?(f(),c("span",$," 请上传头像 ")):b("",!0),s("input",{type:"file",ref_key:"fileInput",ref:n,accept:"image/*",class:"hidden",onChange:w},null,544),a.value?(f(),c("div",j," 上传中... ")):b("",!0)],36)]),s("div",C,[e[7]||(e[7]=s("div",{class:"w-[7vw] pl-[1.5vw]"},"用户名",-1)),m(s("input",{type:"text",class:"border border-gray-400 rounded-sm focus:outline-none focus:border-blue-500 py-1.5 px-4","onUpdate:modelValue":e[3]||(e[3]=l=>t.value.userName=l)},null,512),[[p,t.value.userName]])]),s("div",F,[e[8]||(e[8]=s("div",{class:"w-[7vw] pl-[1.5vw]"},"绑定手机",-1)),m(s("input",{type:"text",class:"border border-gray-400 rounded-sm focus:outline-none focus:border-blue-500 py-1.5 px-4","onUpdate:modelValue":e[4]||(e[4]=l=>t.value.userPhoneNumber=l)},null,512),[[p,t.value.userPhoneNumber]])]),s("div",M,[e[9]||(e[9]=s("div",{class:"w-[7vw] pl-[1.5vw]"},"绑定邮箱",-1)),m(s("input",{type:"text",class:"border border-gray-400 rounded-sm focus:outline-none focus:border-blue-500 py-1.5 px-4","onUpdate:modelValue":e[5]||(e[5]=l=>t.value.userEmail=l)},null,512),[[p,t.value.userEmail]])])])]))}});export{B as default};
